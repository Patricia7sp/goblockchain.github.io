!function(){"use strict";function getStaticURL(){var url,subdomain,static_url;return url=window.location.href.split("//")[1],subdomain=url.split(".")[0],static_url=subdomain.indexOf("su-cms")>-1?"http://"+subdomain+".s3.amazonaws.com":subdomain.indexOf("cms-staging")>-1?"https://su-cms-staging.s3.amazonaws.com":url.indexOf("su.org")>-1?"https://su-cms-prod.s3.amazonaws.com":""}angular.module("app",["ui.router","listing","bios"]).constant("STATIC_URL",getStaticURL())}(),function(){"use strict";angular.module("app").directive("head",["$rootScope","$compile","$state",function($rootScope,$compile,$state){return{restrict:"E",link:function($scope,elem,attrs,ctrls){function applyStyles(state,action){var sheets=state?state.css:null;if(state.parent){var parentState=$state.get(state.parent);applyStyles(parentState,action)}sheets&&(Array.isArray(sheets)||(sheets=[sheets]),angular.forEach(sheets,function(sheet){action(sheet)}))}var html='<link rel="stylesheet" ng-repeat="(routeCtrl, cssUrl) in routeStyles" ng-href="{{cssUrl}}" />',el=$compile(html)($scope);elem.append(el),$scope.routeStyles={},$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){applyStyles(fromState,function(sheet){delete $scope.routeStyles[sheet]}),applyStyles(toState,function(sheet){$scope.routeStyles[sheet]=sheet})})}}}]).directive("file",["$rootScope","$http",function($rootScope,$http){function uploadImageToS3(file,folder,listing){var folder=folder||"";if(file){if(file.size>5242880)return void alert("Maximum image size allowed is 5Mb");if(listing){listing.image_name=folder+file.name.split("/").pop();try{$scope.$apply()}catch(err){}}$http.post("/get_presigned_AWS_url/",{filename:file.name,type:file.type,folder:"media/"+folder}).then(function(response){console.log(response.data.url),console.log(file),$http.put(response.data.url,file,{headers:{"Content-Type":file.type,"Access-Control-Allow-Headers":"*"}}).then(function(response){alert("Upload Done!"),console.log(response)},function(error){alert("An Error Occurred Attaching Your File"),console.error(error)})},function(){alert("An Error Occurred Attaching Your File"),console.error(error)})}}return{restrict:"AE",scope:{file:"@",listing:"=",folder:"@"},link:function(scope,element,attrs){element.bind("change",function(event){var files=event.target.files,file=files[0];scope.file=file,console.log(scope),uploadImageToS3(file,scope.folder,scope.listing),scope.$apply()})}}}])}(),function(){"use strict";function routesConfig($stateProvider,$urlRouterProvider,$locationProvider,$sceDelegateProvider,STATIC_URL){var listing_name;$sceDelegateProvider.resourceUrlWhitelist(["self",STATIC_URL+"/**"]),$urlRouterProvider.otherwise("/"),$stateProvider.state("angular",{url:"/angular",resolve:{},template:"<br><h1>Angular page failed to load. Check Url.</h1>"}).state("enterprise",{url:"/enterprise",resolve:{},templateUrl:STATIC_URL+"/templates/enterprise_home.html"}).state("enterprise1",{url:"/enterprise/",resolve:{},templateUrl:STATIC_URL+"/templates/enterprise_home.html"}).state("su_enterprise",{url:"/enterprise/edit/",resolve:{listingData:getListings},templateUrl:STATIC_URL+"/static/components/enterprise/enterprise_edit.html",controller:"EnterpriseListingController",controllerAs:"vm",css:[STATIC_URL+"/static/components/enterprise/enterprise.css",STATIC_URL+"/static/components/news_listing/listing.css"]}).state("su_enterprise_all",{url:"/enterprise/all/",resolve:{listingData:getListings},templateUrl:STATIC_URL+"/static/components/enterprise/listing.html",controller:"EnterpriseListingController",controllerAs:"vm",css:[STATIC_URL+"/static/components/enterprise/enterprise.css",STATIC_URL+"/static/components/news_listing/listing.css"]}).state("staff",{url:"/about/team/",resolve:{},templateUrl:STATIC_URL+"/static/components/listing/listing.html",controller:"ListingController",controllerAs:"vm",css:STATIC_URL+"/static/components/listing/listing.css"}).state("staffDetail",{url:"/about/team/:staff/",resolve:{},templateUrl:STATIC_URL+"/static/components/listing/listingDetail.html",controller:"ListingController",controllerAs:"vm",css:STATIC_URL+"/static/components/listing/listing.css"}).state("facultyIndex",{url:"/about/faculty/",templateUrl:STATIC_URL+"/static/components/faculty_bios/bios_list.html",controller:"BiosController",controllerAs:"vm",css:STATIC_URL+"/static/components/listing/listing.css",resolve:{}}).state("facultyDetail",{url:"/about/faculty/:faculty/",templateUrl:STATIC_URL+"/static/components/faculty_bios/bios_detail.html",controller:"BiosController",controllerAs:"vm",css:STATIC_URL+"/static/components/listing/listing.css",resolve:{}}),listing_name="su_news",$stateProvider.state(listing_name,{url:"/",resolve:{},templateUrl:STATIC_URL+"/static/components/news_listing/listing.html",controller:"NewsListingController",controllerAs:"vm",css:STATIC_URL+"/static/components/news_listing/listing.css"}).state(listing_name+"_all",{url:"/"+listing_name+"/all/",resolve:{},templateUrl:STATIC_URL+"/static/components/news_listing/allListings.html",controller:"NewsListingController",controllerAs:"vm",css:STATIC_URL+"/static/components/news_listing/listing.css"}).state(listing_name+"_detail",{url:"/"+listing_name+"/:"+listing_name+"/",resolve:{},templateUrl:STATIC_URL+"/static/components/news_listing/listingDetail.html",controller:"NewsListingController",controllerAs:"vm",css:STATIC_URL+"/static/components/news_listing/listing.css"}),$locationProvider.html5Mode(!0),$locationProvider.hashPrefix("!")}function getListings($http){return $http.get("/api/su_enterprise/")}angular.module("app").config(routesConfig),routesConfig.$inject=["$stateProvider","$urlRouterProvider","$locationProvider","$sceDelegateProvider","STATIC_URL"]}(),function(){function biosConfig($httpProvider){$httpProvider.defaults.xsrfCookieName="csrftoken",$httpProvider.defaults.xsrfHeaderName="X-CSRFToken"}angular.module("bios",["ngTagsInput"]).config(biosConfig).constant("DEFAULT_IMAGE_URL","https://su-cms-staging.s3.amazonaws.com/media/staff_headshots/placeholder.jpg"),biosConfig.$inject=["$httpProvider"]}(),function(){"use strict";function listingConfig($httpProvider){$httpProvider.defaults.xsrfCookieName="csrftoken",$httpProvider.defaults.xsrfHeaderName="X-CSRFToken"}angular.module("listing",["ngTagsInput"]).config(listingConfig).constant("DEFAULT_IMAGE_URL","https://su-cms-staging.s3.amazonaws.com/media/staff_headshots/placeholder.jpg"),listingConfig.$inject=["$httpProvider"]}(),function(){function BiosFactory($http){function all(base_url,page){return page&&(base_url+="?page="+page),$http.get(base_url)}function get(base_url,data){return $http.get(base_url+"?name="+data.faculty.replace(/_/g," "))}function forceExternalLinksToLoad(){for(var links=document.getElementsByTagName("a"),i=0;i<links.length;i++)links[i].setAttribute("target","_self")}function activateAnchorLinks(){function activateAnchorLinks(){links=document.getElementsByTagName("a")}var links=[],new_link="";$(document).ready(activateAnchorLinks()),$(document).ready(function(){for(var i=0;i<links.length;i++)links[i].href.indexOf("#")>-1&&"#"!=links[i].href&&(new_link=links[i].ownerDocument.URL+links[i].hash,$(links[i]).attr("href",new_link))})}function addActiveClass(page){var old_active=document.querySelector(".page-number.active"),page_numbers=document.querySelectorAll(".page-number"),new_active=page_numbers[page];angular.element(old_active).removeClass("active"),angular.element(new_active).addClass("active")}function loadPage(base_url,page){return all(base_url,page)}var factory={all:all,get:get,forceExternalLinksToLoad:forceExternalLinksToLoad,addActiveClass:addActiveClass,loadPage:loadPage,activateAnchorLinks:activateAnchorLinks};return factory}angular.module("bios").factory("BiosFactory",BiosFactory),BiosFactory.$inject=["$http"]}(),function(){"use strict";function ListingFactory($http,$state){function all(base_url,page){return page&&(base_url+="?page="+page),$http.get(base_url)}function search(query,search_field,page,base_url){var url=base_url+"?query="+query+"&search_field="+search_field+"&page="+page;return $http.get(url)}function create(base_url,data){return $http.post(base_url,data)}function get(base_url,detail){return $http.get(base_url+detail+"/")}function remove(base_url,detail){return $http["delete"](base_url+detail+"/")}function put(base_url,data,detail){return $http.put(base_url+detail+"/",data)}function forceExternalLinksToLoad(){for(var links=document.getElementsByTagName("a"),i=0;i<links.length;i++)links[i].getAttribute("target")||links[i].setAttribute("target","_self")}function activateAnchorLinks(){function activateAnchorLinks(){links=document.getElementsByTagName("a")}var links=[],new_link="";$(document).ready(activateAnchorLinks()),$(document).ready(function(){for(var i=0;i<links.length;i++)links[i].href.indexOf("#")>-1&&"#"!=links[i].href&&(new_link=links[i].ownerDocument.URL+links[i].hash,$(links[i]).attr("href",new_link))})}function showSpinner(){angular.element("#main-view").css("display","none"),angular.element(".spinner").css("display","block")}function hideSpinner(){angular.element("#main-view").css("display","block"),angular.element(".spinner").css("display","none")}function addActiveClass(page){var old_active=document.querySelector(".page-number.active"),page_numbers=document.querySelectorAll(".page-number"),new_active=page_numbers[page];angular.element(old_active).removeClass("active"),angular.element(new_active).addClass("active")}function generateNoOfPages(no_of_items,items_per_page){var no_of_pages=Math.ceil(no_of_items/items_per_page);return Array.apply(null,{length:no_of_pages}).map(Number.call,Number).map(function(x){return x+1})}function loadPage(base_url,page){return all(base_url,page)}var factory={all:all,create:create,get:get,put:put,remove:remove,search:search,forceExternalLinksToLoad:forceExternalLinksToLoad,addActiveClass:addActiveClass,generateNoOfPages:generateNoOfPages,loadPage:loadPage,activateAnchorLinks:activateAnchorLinks,hideSpinner:hideSpinner,showSpinner:showSpinner,page:1,user_email:""};return factory}angular.module("listing").factory("ListingFactory",ListingFactory),ListingFactory.$inject=["$http","$state"]}(),function(){"use strict";function EnterpriseListingController(ListingFactory,$scope,listingData,$state,$timeout,$sce,DEFAULT_IMAGE_URL){function activate(){ListingFactory.hideSpinner(),$state.current.name==listing_name||$state.current.name==listing_name+"_all"?(getAllListings(),placeImageInMainNav(),$state.current.name==listing_name&&(setTimeout(activateOwlCarousels,1e3),vm.showEditButtons||setTimeout(activateTicker,1e3)),vm.is_admin&&(vm.showEditButtons=!0),ListingFactory.forceExternalLinksToLoad()):getListing($state.params[listing_name])}function activateTicker(){var ticker=angular.element("ul.ticker");ticker.children(":first").show().siblings().hide(),setInterval(function(){ticker.find(":visible").fadeOut("slow",function(){angular.element(this).appendTo(ticker),ticker.children(":first").fadeIn("slow")})},6e3)}function activateOwlCarousels(){angular.element(".banner-row.owl-carousel").owlCarousel({loop:!0,responsive:{0:{items:1}},smartSpeed:900,autoplay:!0,autoplayTimeout:5e3,nav:!0,navText:[]}),angular.element(".explore-row .owl-carousel").owlCarousel({loop:!0,margin:55,stagePadding:50,responsive:{0:{items:1},575:{items:2},768:{items:3}},dotEach:!0,nav:!0,navText:[],smartSpeed:900}),angular.element(".success-row .owl-carousel").owlCarousel({loop:!0,margin:50,stagePadding:50,responsive:{0:{items:1},768:{items:2}},dotEach:!0,nav:!0,navText:[],smartSpeed:900})}function placeImageInMainNav(){angular.element("nav .main > li#enterprise > a").hover(function(){angular.element("#nav-image").remove();var box=angular.element("<div>",{id:"nav-image"});box.css({background:"url(https://su-cms-prod.s3.amazonaws.com/media/filer_public/a7/22/a7226705-3f3e-42bc-8c54-b2310a6df732/ray_kurzweil_headshot.png)","background-position":"center center!important","background-repeat":"no-repeat!important","background-size":"contain!important",position:"absolute",top:"90%",left:"100%",width:"300px",height:"300px","z-index":100}),angular.element("nav .main").append(box)},function(){}),angular.element("nav .main").hover(function(){},function(){angular.element("#nav-image").remove()})}function toggleDropdown(){var dropdown=angular.element(".dropdown-menu");"none"==dropdown.css("display")?(dropdown.css("display","block"),dropdown.css("opacity",1)):(dropdown.css("display","none"),dropdown.css("opacity",0))}function getAllListings(){return ListingFactory.all(base_url).then(function(response){return paginate(response.data.count),vm.allListings=response.data.results,vm.catListings=categorizeListings(response.data.results.slice(),vm.categories),categorizeResources(vm.catListings,"resources"),response.data.results})}function getListing(id){return ListingFactory.get(base_url,id).then(function(response){return vm.listing=response.data,vm.listing.date&&(vm.listing.date=new Date(vm.listing.date)),response.data})}function searchListing(research){research&&(vm.current_page=1),ListingFactory.search(vm.query,vm.search_field_selected,vm.current_page,base_url).then(successCallBackWithPagination,errorCallback)}function addListing(){return vm.new_listing.date=serializeDate(vm.new_listing.date),ListingFactory.create(base_url,vm.new_listing).then(function(response){var listing=response.data;return vm.listing.push(listing),vm.successMessage="New listing has been created",vm.new_listing={},Object.assign(vm.new_listing,new_listing),vm.errorMessage="",getAllListings(),response.data},function(response){var errorStr=getErrorStr(response);vm.errorMessage="New listing could not be created due to error( "+errorStr+")",vm.successMessage="",console.error(response)})}function editListing(listing){return listing.date=serializeDate(listing.date),ListingFactory.put(base_url,listing,listing.id).then(function(response){return listing=response.data,vm.successMessage="listing has been updated",vm.errorMessage="",listing},function(response){var errorStr=getErrorStr(response);vm.errorMessage="Listing could not be updated due to error( "+errorStr+")",vm.successMessage="",console.error(response)})}function editItem(item,event){event.preventDefault(),vm.showDetail=!0,vm.listing=item,Object.assign(vm.oldListing,vm.listing)}function preview(listing){vm.showDetail=!1,JSON.stringify(listing)!==JSON.stringify(vm.oldListing)&&vm.changedListings.push(listing)}function toggleEditButtons(){vm.showEditButtons?(vm.showEditButtons=!1,angular.element("#toggle-admin").html("Admin Page"),activateTicker()):(vm.showEditButtons=!0,angular.element("#toggle-admin").html("Preview"))}function saveChanges(){for(var i=0;i<vm.changedListings.length;i++)editListing(vm.changedListings[i]);vm.changedListings=[],vm.oldListing={}}function reload(){$state.go($state.current,{},{reload:!0})}function filter(category){if(vm.listing.constructor===Array){var element=document.getElementById("banner");switchClassToElement(element,"active"),vm.category=category,searchListing(!0)}}function switchClassToElement(element,className){var element=angular.element(element);element.siblings().each(function(){angular.element(this).removeClass(className)}),element.addClass(className)}function filterListings(){if(vm.category){vm.filteredListings=[];for(var i=0;i<vm.allListings.length;i++)vm.allListings[i].category===vm.category&&vm.filteredListings.push(vm.allListings[i]);vm.allListings=vm.filteredListings,vm.category=""}}function categorizeListings(articles,categories){for(var categorizedArticles={},i=0;i<articles.length;i++)if(articles[i].publish)for(var n=0;n<categories.length;n++)articles[i].category===categories[n]&&(categorizedArticles[categories[n]]?categorizedArticles[categories[n]].push(articles[i]):categorizedArticles[categories[n]]=[articles[i]]);return categorizedArticles}function categorizeResources(articles,category){for(var resourceCategories={Publications:[],"On-Demand Webinars":[],Videos:[]},i=0;i<articles[category].length;i++){var sub_cat=articles[category][i].info;for(var item in resourceCategories)sub_cat===item&&resourceCategories[item].push(articles[category][i])}articles[category]=resourceCategories}function getErrorStr(response){var errorStr="";return"string"==typeof response.data?errorStr=response.data.slice(0,200):response.data instanceof Array?errorStr=response.data[Object.keys(response.data)[0]]:"object"==typeof response.data?errorStr=response.data[Object.keys(response.data)[0]][0]:(console.info("Failed to parse error string"),console.info(response)),errorStr}function removeListing(listing){var yes=confirm("Please confirm listing deletion.\nThis action is permanent!");yes&&ListingFactory.remove(base_url,listing.id).then(function(){$state.go(listing_name+"_all")},function(response){console.error(response)})}function paginate(no_of_results){vm.pages=ListingFactory.generateNoOfPages(no_of_results,PAGE_SIZE),$scope.$on("$viewContentLoaded",function(){$timeout(function(){ListingFactory.addActiveClass(vm.current_page)},0)})}function serializeDate(date){return date&&date.length>0?date.toJSON().slice(0,10):""}function loadPage(page){vm.current_page=page,searchListing(),ListingFactory.addActiveClass(page)}function nextPage(){vm.current_page<vm.pages.length&&(vm.current_page+=1,loadPage(vm.current_page))}function previousPage(){vm.current_page>1&&(vm.current_page-=1,loadPage(vm.current_page))}function successCallBackWithPagination(response){vm.allListings=response.data.results,vm.pages=ListingFactory.generateNoOfPages(response.data.count,PAGE_SIZE),filterListings()}function errorCallback(response){console.error(response)}function renderHtml(html_code){return $sce.trustAsHtml(html_code)}var vm=this,listing_name="su_enterprise",base_url="/api/"+listing_name+"/";vm.listing=[],vm.allListings=[],vm.changedListings=[],vm.catListings={},vm.new_listing={},vm.oldListing={},vm.default_image_url=DEFAULT_IMAGE_URL,vm.getAllListings=getAllListings,vm.addListing=addListing,vm.editListing=editListing,vm.loadPage=loadPage,vm.getListing=getListing,vm.removeListing=removeListing,vm.searchListing=searchListing,vm.renderHtml=renderHtml,vm.filter=filter,vm.toggleDropdown=toggleDropdown,vm.is_admin=listingData.data.is_admin,vm.showDetail=!1,vm.showEditButtons=!1,vm.toggleEditButtons=toggleEditButtons,vm.reload=reload,vm.editItem=editItem,vm.saveChanges=saveChanges,vm.preview=preview,vm.openPage=ListingFactory.openPage,vm.showEditForm=!0,vm.loadPage=loadPage,vm.pages=[1],vm.current_page=1,vm.nextPage=nextPage,vm.previousPage=previousPage,vm.query="";var PAGE_SIZE=100;vm.categories=[];var new_listing={};new_listing.title="Test title",new_listing.category="text",new_listing.info="",new_listing.image_name="",new_listing.link="test link",new_listing.date={},new_listing.publish=!0,vm.new_listing={},Object.assign(vm.new_listing,new_listing),$timeout(function(){activate()},0),$scope.$on("$stateChangeStart",function(event,toState){toState.resolve&&ListingFactory.showSpinner()}),$scope.$on("$stateChangeSuccess",function(event,toState){toState.resolve&&ListingFactory.hideSpinner()}),vm.additional_form_fields=[{name:"title",display_name:"Item Title",placeholder:"",restricted:!1},{name:"link",display_name:"Item Link",placeholder:"",restricted:!1}],vm.categories=["banner","text","explore","quotes","help","ticker","success","resources"],vm.detail_fields=["date","title","info"],vm.search_fields=["title","category"],vm.search_field_selected=vm.search_fields[0],vm.preloadUnApprovedFields=[],vm.approvalNeededFields=[]}angular.module("listing").controller("EnterpriseListingController",EnterpriseListingController),EnterpriseListingController.$inject=["ListingFactory","$scope","listingData","$state","$timeout","$sce","DEFAULT_IMAGE_URL"]}(),function(){function BiosController(BiosFactory,ListingFactory,$http,$scope,$anchorScroll,$state,$sce,DEFAULT_IMAGE_URL){function activate(){"facultyDetail"==$state.current.name?getFaculty($state.params):getAllFaculty(),BiosFactory.forceExternalLinksToLoad(),BiosFactory.activateAnchorLinks()}function populateFacultyObject(data){vm.faculty={CEO:[],Chair:[],"Co-Chair":[],Faculty:[],Founder:[],"Guest Speaker":[],"Head of Faculty":[],"Principal Faculty":[],"SU Staff":[],"Vice Chair":[]};for(var i=0;i<data.length;i++)null!==data[i].faculty_member_type&&vm.faculty[data[i].faculty_member_type].push(data[i])}function getAllFaculty(){return BiosFactory.all(api_root+public_url).then(function(response){console.log("Loaded public faculty info."),populateFacultyObject(response.data)})}function openPage(page,params){if(BiosFactory.page=vm.current_page,params){var name=params.first_name+"_"+params.surname;$state.go(page,{faculty:name.replace(" ","_")})}else $state.go(page)}function getFaculty(staff){return BiosFactory.get(api_root+public_url,staff).then(function(response){1==response.data.length?(vm.selected_faculty=response.data[0],vm.user_email=response.data.user_email,getLinks(vm.selected_faculty.id),getPublications(vm.selected_faculty.id),getTalks(vm.selected_faculty.id),getVideos(vm.selected_faculty.id),objectifyExpertise(vm.selected_faculty)):console.error("Got the wrong number of results: "+response.data.length)})}function getLinks(faculty_id){return $http.get(api_root+links_url+"?faculty_member="+faculty_id).then(function(response){vm.links=response.data})}function getPublications(faculty_id){return $http.get(api_root+publications_url+"?faculty_member="+faculty_id).then(function(response){vm.publications=response.data})}function getTalks(faculty_id){return $http.get(api_root+talks_url+"?faculty_member="+faculty_id).then(function(response){vm.talks=response.data})}function getVideos(faculty_id){return $http.get(api_root+videos_url+"?faculty_member="+faculty_id).then(function(response){vm.videos=response.data;for(var i=0;i<vm.videos.length;i++)if(0===vm.videos[i].url.indexOf("http://")&&(vm.videos[i].url=vm.videos[i].url.replace("http://","https://")),0===vm.videos[i].url.indexOf("https://youtube.com/embed/"))vm.videos[i].url=$sce.trustAsResourceUrl(vm.videos[i].url);else{var vidId;vm.videos[i].url.indexOf("youtube.com")>-1?vidId=vm.videos[i].url.split("?v=")[1].split("&")[0]:vm.videos[i].url.indexOf("youtu.be")>-1&&(vidId=vm.videos[i].url.split("youtu.be/")[1].split("&")[0]),vidId&&(vm.videos[i].url=$sce.trustAsResourceUrl("https://youtube.com/embed/"+vidId))}})}function renderHtml(html_code){return $sce.trustAsHtml(html_code)}function objectifyExpertise(){if(vm.faculty.expertise){var expertise=vm.faculty.expertise.split(",");vm.faculty.expertise=[];for(var i=0;i<expertise.length;i++)vm.faculty.expertise.push({text:expertise[i]})}else vm.faculty.expertise=[]}function scrollTo(hash){$anchorScroll(hash)}window.MY_SCOPE=this;var vm=this;vm.faculty=[],vm.default_image_url=DEFAULT_IMAGE_URL,vm.getFaculty=getFaculty,vm.getAllFaculty=getAllFaculty,vm.openPage=openPage,vm.renderHtml=renderHtml,vm.scrollTo=scrollTo,vm.linkedin_icon=$sce.trustAsResourceUrl("https://"+global_AWS_BUCKET+".s3.amazonaws.com/static/img/icon-linkedin.png"),vm.facebook_icon=$sce.trustAsResourceUrl("https://"+global_AWS_BUCKET+".s3.amazonaws.com/static/img/icon-facebook.png"),vm.medium_icon=$sce.trustAsResourceUrl("https://"+global_AWS_BUCKET+".s3.amazonaws.com/static/img/icon-medium.png"),vm.twitter_icon=$sce.trustAsResourceUrl("https://"+global_AWS_BUCKET+".s3.amazonaws.com/static/img/icon-twitter.png");var api_root=global_FACULTY_API_BACKEND+"/",public_url="faculty_members_public/",links_url="links_public/",publications_url="publications_public/",talks_url="talks_public/",videos_url="videos_public/";$state.current&&activate(),$scope.$on("$stateChangeStart",function(event,toState){toState.resolve&&ListingFactory.showSpinner()}),$scope.$on("$stateChangeSuccess",function(event,toState){toState.resolve&&ListingFactory.hideSpinner()})}angular.module("bios").controller("BiosController",BiosController),BiosController.$inject=["BiosFactory","ListingFactory","$http","$scope","$anchorScroll","$state","$sce","DEFAULT_IMAGE_URL"]}(),function(){"use strict";function ListingController(ListingFactory,$scope,$state,$timeout,$sce,DEFAULT_IMAGE_URL){function activate(){"staff"==$state.current.name?searchStaff():getStaff($state.params.staff),ListingFactory.forceExternalLinksToLoad(),ListingFactory.activateAnchorLinks()}function searchStaff(research){return research&&(vm.current_page=1),ListingFactory.search(vm.query,vm.search_field,vm.current_page,base_url).then(successCallBackWithPagination,errorCallback)}function getStaff(lookup_url){return ListingFactory.get(base_url,lookup_url).then(function(response){return vm.staff=response.data,vm.is_admin=response.data.is_admin,objectifyExpertise(vm.staff),$timeout(function(){fixBrokenBackgroundImages()},3e3),vm.staff})}function renderHtml(html_code){return $sce.trustAsHtml(html_code)}function openPage(page,params){ListingFactory.page=vm.current_page,params?$state.go(page,{staff:params.lookup_url}):$state.go(page)}function loadPage(page){vm.current_page=page,searchStaff(),ListingFactory.addActiveClass(page)}function nextPage(){vm.current_page<vm.pages.length&&(vm.current_page+=1,loadPage(vm.current_page))}function previousPage(){vm.current_page>1&&(vm.current_page-=1,loadPage(vm.current_page))}function errorCallback(response){console.error(response)}function addStaff(){addExtraFields(vm.new_staff),addEmail(vm.new_staff),stringifyExpertise(vm.new_staff),ListingFactory.create(base_url,vm.new_staff).then(function(response){var staff=response.data;vm.staff.push(staff),vm.successMessage="New profile has been created",vm.new_staff={},vm.errorMessage=""},function(response){console.error(response),vm.errorMessage="New profile could not be created due to error( "+response.data.name+")",vm.successMessage=""})}function removeStaff(staff){var yes=confirm("Please confirm profile deletion.\nThis action is permanent!");yes&&ListingFactory.remove(base_url,staff.lookup_url).then(function(response){$state.go("staff")},function(response){console.error(response)})}function editStaff(staff){addLastName(staff),stringifyExpertise(staff),ListingFactory.put(base_url,staff,staff.lookup_url).then(function(response){staff=response.data,objectifyExpertise(staff),vm.successMessage="Profile has been updated",vm.errorMessage=""},function(response){vm.errorMessage="Profile could not be updated due to error( "+response.data.name+")",vm.successMessage="",console.error(response)})}function stringifyExpertise(staff){var expertiseStr="";if(staff.expertise){for(var i=0,len=staff.expertise.length;i<len;i++)staff.expertise[i].text&&(expertiseStr+=staff.expertise[i].text,expertiseStr+=",");staff.expertise=expertiseStr.slice(0,-1)}else staff.expertise=""}function objectifyExpertise(){if(vm.staff.expertise){var expertise=vm.staff.expertise.split(",");vm.staff.expertise=[];for(var i=0;i<expertise.length;i++)vm.staff.expertise.push({text:expertise[i]})}else vm.staff.expertise=[]}function addExtraFields(staff){staff.last_name=staff.name.split(" ")[1]||staff.name.split(" ")[0],staff.lookup_url=staff.name.split(" ").join("-").toLowerCase()}function addLastName(staff){var names=staff.name.split(" ");staff.last_name=names[names.length-1]}function addEmail(staff){var names=staff.name.toLowerCase().split(" ");names.length>1?staff.email=names[0]+"."+names[names.length-1]+"@su.org":staff.email=names[0]+"su.org"}function approveStaffChanges(field){vm.staff[field]=vm.staff[field+"_unapproved"],addLastName(vm.staff),stringifyExpertise(vm.staff),ListingFactory.put(base_url,vm.staff,vm.staff.lookup_url).then(successCallBackWithMessage,errorCallBackWithMessage)}function fixBrokenBackgroundImages(){var imageURLs=angular.element(".image");imageURLs.each(function(index,element){var src=angular.element(element).children()[0].src;src.indexOf("jpg")==-1&&angular.element(element).css("background-image",'url("'+DEFAULT_IMAGE_URL+'")')})}function successCallBackWithPagination(response){return vm.staff=response.data.results,vm.is_admin=response.data.is_admin,console.log(vm.is_admin),vm.pages=ListingFactory.generateNoOfPages(response.data.count,PAGE_SIZE),$timeout(function(){ListingFactory.addActiveClass(vm.current_page)},500),$timeout(function(){fixBrokenBackgroundImages()},3e3),$timeout(function(){console.clear()},2e3),vm.staff}function successCallBackWithMessage(response,message){message="Approval was successful"|message,vm.staff=response.data,vm.successMessage=message,vm.errorMessage=""}function errorCallBackWithMessage(response,message){message="There was an error during approval"|message,vm.errorMessage=message,vm.successMessage="",console.error(response)}var vm=this;vm.new_staff={},vm.staff=[],vm.default_image_url=DEFAULT_IMAGE_URL,vm.getStaff=getStaff,vm.addStaff=addStaff,vm.removeStaff=removeStaff,vm.editStaff=editStaff,vm.openPage=openPage,vm.showEditForm=!1,vm.loadPage=loadPage,vm.pages=[1],vm.current_page=ListingFactory.page,vm.nextPage=nextPage,vm.previousPage=previousPage,vm.approveStaffChanges=approveStaffChanges,vm.query="",vm.searchStaff=searchStaff,vm.search_field="name",vm.addLastName=addLastName,vm.renderHtml=renderHtml,vm.page=1;var base_url="/staff/",PAGE_SIZE=20;$state.current&&activate(),$scope.$on("$stateChangeStart",function(event,toState){toState.resolve&&ListingFactory.showSpinner()}),$scope.$on("$stateChangeSuccess",function(event,toState){toState.resolve&&ListingFactory.hideSpinner()})}angular.module("listing").controller("ListingController",ListingController),ListingController.$inject=["ListingFactory","$scope","$state","$timeout","$sce","DEFAULT_IMAGE_URL"]}(),function(){"use strict";function NewsListingController(ListingFactory,$scope,$state,$timeout,$sce,DEFAULT_IMAGE_URL){function activate(){$state.current.name==listing_name||$state.current.name==listing_name+"_all"?(getAllListings(),ListingFactory.forceExternalLinksToLoad()):getListing($state.params[listing_name])}function getAllListings(){return ListingFactory.all(base_url).then(function(response){return vm.allListings=response.data.results.slice(),vm.listing=response.data.results.slice(),categorizeArticles(vm.listing),datifyDates(vm.listing),vm.is_admin=response.data.is_admin,paginate(response.data.count),response.data.results})}function getListing(id){return ListingFactory.get(base_url,id).then(function(response){return vm.listing=response.data,vm.listing.date&&(vm.listing.date=new Date(vm.listing.date)),vm.is_admin=response.data.is_admin,response.data})}function searchListing(research){research&&(vm.current_page=1),ListingFactory.search(vm.query,vm.search_field_selected,vm.current_page,base_url).then(successCallBackWithPagination,errorCallback)}function addListing(){return vm.new_listing.date=serializeDate(vm.new_listing.date),ListingFactory.create(base_url,vm.new_listing).then(function(response){var listing=response.data;return vm.listing.push(listing),vm.successMessage="New listing has been created",vm.new_listing={},vm.errorMessage="",getAllListings(),response.data},function(response){var errorStr=getErrorStr(response);vm.errorMessage="New listing could not be created due to error( "+errorStr+")",vm.successMessage=""})}function editListing(){return vm.listing.date=serializeDate(vm.listing.date),ListingFactory.put(base_url,vm.listing,vm.listing.id).then(function(response){return vm.listing=response.data,vm.successMessage="listing has been updated",vm.errorMessage="",vm.listing},function(response){var errorStr=getErrorStr(response);vm.errorMessage="Listing could not be updated due to error( "+errorStr+")",vm.successMessage="",console.error(response)})}function getErrorStr(response){var errorStr="";return"string"==typeof response.data?errorStr=response.data.slice(0,200):response.data instanceof Array?errorStr=response.data[Object.keys(response.data)[0]]:"object"==typeof response.data?errorStr=response.data[Object.keys(response.data)[0]][0]:(console.info("Failed to parse error string"),console.info(response)),errorStr}function removeListing(listing){var yes=confirm("Please confirm listing deletion.\nThis action is permanent!");
yes&&ListingFactory.remove(base_url,listing.id).then(function(){$state.go(listing_name+"_all")},function(response){console.error(response)})}function paginate(no_of_results){vm.pages=ListingFactory.generateNoOfPages(no_of_results,PAGE_SIZE),$scope.$on("$viewContentLoaded",function(){$timeout(function(){ListingFactory.addActiveClass(vm.current_page)},0)})}function datifyDates(listings){for(var i=0;i<listings.length;i++)void 0===listings[i].date&&null===listings[i].date||(listings[i].date=new Date(listings[i].date),listings[i].date=formatDate(listings[i].date))}function serializeDate(date){return date?date.toJSON().slice(0,10):""}function formatDate(date){if(date&&"Invalid Date"!=date){var monthNames=["Jan.","Feb.","Mar.","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."],day=date.getDate(),monthIndex=date.getMonth(),year=date.getFullYear();return monthNames[monthIndex]+" "+day+", "+year}return""}function loadPage(page){vm.current_page=page,searchListing(),ListingFactory.addActiveClass(page)}function nextPage(){vm.current_page<vm.pages.length&&(vm.current_page+=1,loadPage(vm.current_page))}function previousPage(){vm.current_page>1&&(vm.current_page-=1,loadPage(vm.current_page))}function successCallBackWithPagination(response){vm.allListings=response.data.results,vm.is_admin=response.data.is_admin,vm.pages=ListingFactory.generateNoOfPages(response.data.count,PAGE_SIZE)}function errorCallback(response){console.error(response)}function categorizeArticles(articles){for(var i=0;i<articles.length;i++)articles[i].publish===!0&&("gis"==articles[i].category.toLowerCase()?gisAll.push(articles[i]):"hub"==articles[i].category.toLowerCase()?hub.push(articles[i]):"event"==articles[i].category.toLowerCase()&&articles[i].date>today&&vm.events.push(articles[i]));gisAll.reverse(),gisAll.length>=3?(vm.gisLast=gisAll.slice(0)[0],vm.gis.push(gisAll.slice(2,3)[0]),vm.gis.push(gisAll.slice(1,2)[0])):vm.gis=gisAll,hub.reverse(),vm.hubA=hub.slice(0,2),vm.hubB=hub.slice(2,4),vm.events=vm.events.sort(compareByDate).slice(0,4),vm.spaceBanner=getArticle(articles,"banner"),vm.mobileAppBanner=getArticle(articles,"banner")}function compareByDate(a,b){return a.date<b.date?-1:a.date>b.date?1:0}function standardizeDate(date){var mm=date.getMonth()+1,dd=date.getDate();return[date.getFullYear(),(mm>9?"":"0")+mm,(dd>9?"":"0")+dd].join("-")}function getArticle(articles,category){for(var i=0,len=articles.length;i<len;i++)if(articles[i].category==category)return articles.splice(i,1)[0]}function renderHtml(html_code){return $sce.trustAsHtml(html_code)}var vm=this,listing_name="su_news",base_url="/api/"+listing_name+"/";vm.listing=[],vm.allListings=[],vm.new_listing={},vm.default_image_url=DEFAULT_IMAGE_URL,vm.blue_world_url="https://su-cms-prod.s3.amazonaws.com/media/filer_public/ab/52/ab52ef69-7100-4e14-abcf-b5dd81ae7736/global-impact-stories-icon.png",vm.orange_world_url="https://su-cms-prod.s3.amazonaws.com/media/filer_public/b7/e4/b7e4d064-6e38-4354-8c87-3ca3a4cd4bc9/icon-exponential.png",vm.getAllListings=getAllListings,vm.addListing=addListing,vm.editListing=editListing,vm.loadPage=loadPage,vm.getListing=getListing,vm.removeListing=removeListing,vm.searchListing=searchListing,vm.renderHtml=renderHtml,vm.openPage=ListingFactory.openPage,vm.showEditForm=!0,vm.loadPage=loadPage,vm.pages=[1],vm.current_page=1,vm.nextPage=nextPage,vm.previousPage=previousPage,vm.query="",vm.hero_title="At Singularity University",vm.hero_text="We believe our world has the people, technology, and resources to solve any problem, even humanity's most urgent, persistent challenges.",vm.test="test",vm.background="url(https://su-cms-prod.s3.amazonaws.com/media/filer_public/60/03/6003c8c2-06f8-4a34-8340-a5b64e34c58c/hero-earth-homepage-soace.jpg);";var PAGE_SIZE=20;vm.gis=[];var gisAll=[];vm.events=[];var hub=[];vm.hubA=[],vm.hubB=[],vm.gisLast={},vm.spaceBanner={},vm.new_listing.title="Test title",vm.new_listing.category="event",vm.new_listing.info="Test",vm.new_listing.image_name="news_images/placeholder.jpg",vm.new_listing.link="Test title",vm.new_listing.date=new Date,vm.new_listing.publish=!0;var today=standardizeDate(new Date);$timeout(function(){activate()},0),$scope.$on("$stateChangeStart",function(event,toState){toState.resolve&&ListingFactory.showSpinner()}),$scope.$on("$stateChangeSuccess",function(event,toState){toState.resolve&&ListingFactory.hideSpinner()}),vm.additional_form_fields=[{name:"title",display_name:"News Title",placeholder:"",restricted:!1},{name:"info",display_name:"Details (e.g event location)",placeholder:"",restricted:!1},{name:"link",display_name:"Article Link",placeholder:"",restricted:!1}],vm.detail_fields=["date","title","info"],vm.search_fields=["title","category"],vm.search_field_selected=vm.search_fields[0],vm.preloadUnApprovedFields=[],vm.approvalNeededFields=[]}angular.module("listing").controller("NewsListingController",NewsListingController),NewsListingController.$inject=["ListingFactory","$scope","$state","$timeout","$sce","DEFAULT_IMAGE_URL"]}(),jQuery(document).ready(function($){function updateSlides(event){var currentItem=event.item.index;currentSlide=currentItem+1,nextSlide=currentSlide+1,nextSlide>slideCount&&(nextSlide=slideCount),$(window).width()<768?$(".speaker-carousel .title .current").html(currentSlide):$(window).width()<1024?(nextSlide=currentSlide+3,$(".speaker-carousel .title .current").html(currentSlide+" - "+nextSlide)):(nextSlide=currentSlide+5,$(".speaker-carousel .title .current").html(currentSlide+" - "+nextSlide))}function detectOptinMonsterInsert(){$("body").bind("DOMNodeInserted",function(e){if(e.target.tagName){var navHeight=$("nav").outerHeight(),element=$(e.target);if("fixed"==element.css("position")){var topValue=parseInt(element.css("top"),10);topValue<navHeight&&(element.addClass("topOptinMonster"),isOptinMonsterBannerOnTop=!0,shiftNavigationElementsDown(element),element.on("click",function(){moveNavigationElementsBack(),isOptinMonsterBannerOnTop=!1}))}return adjustNavigationElementsAfterResize(),$(e.target)}})}function shiftNavigationElementsDown(insertedElement){setTimeout(function(){putElementBelowInsertOrAtPageTop($("nav"),insertedElement)},1e3)}function moveNavigationElementsBack(){setTimeout(function(){$(".shifted").css({top:"0px"}),$(".shifted").removeClass("shifted")})}function adjustNavigationElementsAfterResize(){$(window).resize(function(){afterFinalEvent(function(){$(window).width()>991&&$("ul.main.shifted").css({top:"0px"}),putElementBelowInsertOrAtPageTop($(".shifted"))},200,"shiftNavbar")})}function putElementBelowInsertOrAtPageTop(bottomElement,insertedElement){insertedElement=insertedElement||$(".topOptinMonster"),bottomElement.addClass("shifted"),setTimeout(function(){bottomElement.css({top:insertedElement.outerHeight()})})}function afterFinalEvent(cb,waitTime,id){id||(id="id"),su_timers[id]&&clearTimeout(su_timers[id]),su_timers[id]=setTimeout(cb,waitTime)}var isOptinMonsterBannerOnTop=!1;if(detectOptinMonsterInsert(),$(".select span").on("click touch",function(e){$(this).parent().hasClass("active")||$(".select.active").removeClass("active"),$(this).parent().toggleClass("active")}),$(".anchor-link-bar").length>0)var anchorTop=$(".anchor-link-bar").offset().top;$(window).scroll(function(){$(window).scrollTop()+$(window).height()>$("footer").offset().top?$(".contact-widget.fixed").hide():$(".contact-widget.fixed").show(),$(".contact-widget .select.active").removeClass("active"),$(".anchor-link-bar").length>0&&($(window).scrollTop()>=anchorTop-75?$(".anchor-link-bar").addClass("fixed"):$(".anchor-link-bar").removeClass("fixed"))}),$(".menu-trigger").on("click touch",function(e){$("nav .main").toggleClass("active"),$(window).width()<768&&$("body").addClass("no-scroll")}),$("nav .main > li > a").on("click touch",function(e){$(window).width()<992&&(e.preventDefault(),$(".main").removeClass("sub").find(".subnav").removeClass("active"),$(this).next(".subnav").length>0&&($(this).next(".subnav").addClass("active").removeAttr("style").parents(".main").addClass("sub"),$("> .row",$(this).next(".subnav")).removeAttr("style")),isOptinMonsterBannerOnTop&&(putElementBelowInsertOrAtPageTop($(".subnav.active")),putElementBelowInsertOrAtPageTop($("nav div.menu-close"))))});var activeSubnav,hideSubnav,showSubnav;$("nav, .logo").hover(function(e){$(window).width()>991&&null!==hideSubnav&&clearTimeout(hideSubnav)},function(e){}),$("nav .main > li > a").hover(function(e){$(window).width()>991&&(null!==hideSubnav&&clearTimeout(hideSubnav),null===activeSubnav?(activeSubnav=$(this).siblings(".subnav"),showSubnav=setTimeout(function(){$("nav").addClass("active"),activeSubnav.css({display:"none",top:"0px","z-index":10}),activeSubnav.slideDown(350,function(){$("> .row",activeSubnav).css({opacity:1,visibility:"visible"})})},250)):(activeSubnav=$(this).siblings(".subnav"),showSubnav=setTimeout(function(){$("nav").addClass("active"),activeSubnav.css({top:"0px","z-index":10}),isOptinMonsterBannerOnTop&&putElementBelowInsertOrAtPageTop(activeSubnav),activeSubnav.slideDown(350,function(){$("> .row",activeSubnav).css({opacity:1,visibility:"visible"}),$("nav .main .subnav").each(function(){$(this).is(activeSubnav)||($("> .row",this).css({opacity:0,visibility:"hidden"}),$(this).slideUp(350,function(){$(this).css({top:"-100%","z-index":0})}))})})},250)))},function(e){$(window).width()>991&&(hideSubnav=setTimeout(function(){$("> .row",activeSubnav).css({opacity:0,visibility:"hidden"}),activeSubnav.slideUp(350,function(){activeSubnav.css({top:"-100%","z-index":0}),activeSubnav=null,$("nav").removeClass("active")})},350))}),$("nav .main > li > .subnav").hover(function(e){$(window).width()>991&&(null!==hideSubnav&&clearTimeout(hideSubnav),activeSubnav=$(this))},function(e){$(window).width()>991&&(hideSubnav=setTimeout(function(){$("> .row",activeSubnav).css({opacity:0,visibility:"hidden"}),activeSubnav.slideUp(350,function(){activeSubnav.css({top:"-100%","z-index":0}),activeSubnav=null,$("nav").removeClass("active")})},350))}),$(".menu-close").on("click touch",function(e){$(this).parent().hasClass("main")?($(this).parents(".main").removeClass("active"),$(window).width()<768&&($("nav .account").hasClass("active")||$("body").removeClass("no-scroll"))):(e.preventDefault(),$(".main").removeClass("sub").find(".subnav").removeClass("active"))}),$("section").on("click touch",function(e){$("nav .active, nav .sub, nav .search-active").removeClass("active").removeClass("sub").removeClass("search-active"),$(window).width()<768&&$("body").removeClass("no-scroll")}),$(".share").on("click touch",function(e){$(".share").toggleClass("active")}),$(".account").on("click touch",function(e){$(".account").toggleClass("active"),$(window).width()<768&&($("nav .main").hasClass("active")||$("body").toggleClass("no-scroll"))});var clickedAlready=!1;$(".search-trigger, .search-trigger-mobile").on("click touch",function(e){clickedAlready||($(window).width()<768&&$(".main").removeClass("sub").find(".subnav").removeClass("active"),$("nav .search").toggleClass("active"),$("nav .propnav").toggleClass("search-active"),$(".search.active input").focus(),clickedAlready=!0),setTimeout(function(){clickedAlready=!1},1e3)});var header_height=$("nav").height();$(document).scrollTop()>header_height?($("nav").addClass("condensed"),$("nav .search").removeClass("active"),$("nav .propnav").removeClass("search-active")):$("nav").removeClass("condensed");$("nav").outerHeight();if($(window).scroll(function(event){$(document).scrollTop()>header_height?($("nav").addClass("condensed"),$(window).width()>768&&$("nav .search").removeClass("active"),$("nav .propnav").removeClass("search-active")):$("nav").removeClass("condensed")}),$(".accordian .title").on("click touch",function(e){e.preventDefault();var background=$(this).parent().data("expanded-background");$(this).siblings(".content").slideToggle().parent().toggleClass("expanded"),background&&$(this).parent().toggleClass(background)}),$(".speaker-carousel").length>0){slideCount=$(".speaker-carousel .speaker").length,$(".speaker-carousel .title .total").html(slideCount),title=$(".title");var carousel=$(".owl-carousel");carousel.owlCarousel({loop:!1,margin:28,nav:!0,slideBy:6,responsiveClass:!0,responsive:{0:{items:1},600:{items:4},1e3:{items:6}}}),carousel.on("initialized.owl.carousel",function(event){updateSlides(event)}),carousel.on("changed.owl.carousel",function(event){updateSlides(event)})}$(window).width()>992&&$(".subnav").each(function(){var height=0,totalHeight=$(".subnav-col-1",this).height(),children=$(".subnav-col-1",this).children(),menuItem={};for(i=0;i<children.length;i++)menuItem=children[i],height+$(menuItem).outerHeight()/2>totalHeight/3+.1*totalHeight&&$(".subnav-col-1",this).children().length>1&&$(".subnav-col-2",this).append(menuItem),height+=$(menuItem).outerHeight();height=0,totalHeight=$(".subnav-col-2",this).height(),children=$(".subnav-col-2",this).children();for(var i=0;i<children.length;i++)menuItem=children[i],height+$(menuItem).outerHeight()/2>totalHeight/2&&$(".subnav-col-2",this).children().length>1&&$(".subnav-col-3",this).append(menuItem),height+=$(menuItem).outerHeight()}),setTimeout(function(){0===$(".hero-image").length&&($("nav").addClass("no-hero"),$($("nav").nextAll(".container-fluid")[0]).css("margin-top",$("nav").outerHeight()))},1e3),"/"==window.location.pathname&&$(".hero-image").addClass("home"),$('a[href*="#"]:not([href="#"])').click(function(e){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var target=$(this.hash);if(target=target.length?target:$("[name="+this.hash.slice(1)+"]"),target.length)return $("html,body").animate({scrollTop:target.offset().top-$("nav").outerHeight()-$(".anchor-link-bar").outerHeight()},1e3),!1}});var su_timers={}});